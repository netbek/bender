!function(e,i){var r=new(i()),t="function"==typeof define&&define.amd,s="undefined"!=typeof module&&module.exports;t?define(r):s?module.exports=r:this[e]=r}("Bender",function(){function e(){this.flags={init:!1},this.config={},this.ratios=[],this.url=void 0,this.$frames=void 0;for(var e,i=[[10,16],[10,15],[9,16],[3,4]],r=0,t=i.length;r<t;r++)e=i[r],this.ratios.push({width:e[0],height:e[1],ratio:e[0]/e[1],name:e[0]+":"+e[1]}),e[0]!==e[1]&&this.ratios.push({width:e[1],height:e[0],ratio:e[1]/e[0],name:e[1]+":"+e[0]})}return e.prototype={prototype:e,getRatioName:function(e,i){for(var r,t=Number(e)/Number(i),s=0,a=this.ratios.length;s<a;s++)if(r=this.ratios[s],r.ratio===t)return r.name},init:function(e){if(!this.flags.init){var i=this;this.flags.init=!0;var r={debug:!1,sitemap:void 0,sitemapUrl:void 0,sitemapBaseUrl:void 0,baseUrl:"",cache:!0,cacheQueryParam:"ts",screens:[]};_.defaults(this.config,e,r);for(var t,s,a,n=jQuery("#frames > ul"),o="",f=0,h=this.config.screens.length;f<h;f++)t=this.config.screens[f],s=t.split("-"),a=i.getRatioName(s[0],s[1]),o+="<li><p>"+s[0]+" x "+s[1]+(a?", "+a:"")+'</p><iframe class="f f-'+s[0]+"-"+s[1]+'"></iframe></li>';if(n.append(o),this.$frames=jQuery("iframe"),_.isNil(this.config.sitemap)){if(_.isNil(this.config.sitemapUrl))throw new Error("Either `sitemap` or `sitemapUrl` should be defined in config.");jQuery.ajax({cache:!1,method:"GET",dataType:"xml",url:this.config.sitemapUrl,error:function(){throw new Error("Could not load sitemap.")},success:function(e,r,t){i.config.sitemap={},jQuery(e).find("url").each(function(){var e=jQuery(this).find("loc").text();if(e.substr(0,i.config.sitemapBaseUrl.length)===i.config.sitemapBaseUrl){var r=e=e.substr(i.config.sitemapBaseUrl.length);""===r&&(r="/"),e=i.config.baseUrl+e,i.config.sitemap[e]=r}}),i.loadFrames()}})}else this.loadFrames()}},loadFrames:function(){if(this.flags.init){var e,i,r,t=this,s=jQuery("#menu"),a=jQuery("<ul />"),n=[];for(e in this.config.sitemap)this.config.sitemap.hasOwnProperty(e)&&n.push(e);for(n.sort(),r=n.length,i=0;i<r;i++){e=n[i],_.isNil(this.config.firstUrl)&&(this.config.firstUrl=e);var o=jQuery('<a href="'+e+'">'+this.config.sitemap[e]+"</a>").on("click.bender",function(e){t.setUrl(jQuery(this).attr("href")),e.preventDefault()}),f=jQuery("<li />");f.append(o),a.append(f)}jQuery('a[href="#"]',s).on("click.bender",function(e){e.preventDefault()}),r&&(jQuery("li.sitemap",s).append(a),t.setUrl(this.config.firstUrl)),s.removeClass("hidden").superfish({delay:100,speed:100})}},setUrl:function(e){if(this.flags.init){if(_.isNil(e))throw new Error("`url` is required");var i=!1===this.config.cache;this.url=this.setCacheQueryParam(e,this.config.cache),i&&(this.$frames.off("load.bender"),this.$frames.on("load.bender",function(){jQuery(this).off("load.bender"),this.contentWindow.location.reload(!0)})),this.$frames.attr("src",this.url)}},isEqualUrl:function(e,i){var r=this.removeCacheQueryParam(e),t=this.removeCacheQueryParam(i);return _.isEqual(r,t)},removeCacheQueryParam:function(e){var i=new Url(e);return _.isFunction(i.query[this.config.cacheQueryParam])||delete i.query[this.config.cacheQueryParam],i},setCacheQueryParam:function(e,i){var r;if(!1!==i)return e;r=Date.now();var t=new Url(e);return t.query[this.config.cacheQueryParam]=r,t.toString()}},e});